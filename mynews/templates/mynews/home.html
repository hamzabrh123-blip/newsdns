{% extends 'mynews/base.html' %}
{% load static %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Mukta:wght@400;700;800&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    :root { --ajtak-red: #cf2030; --dark-bg: #1a1a1a; --soft-bg: #f8f9fa; }
    body { background-color: var(--soft-bg) !important; font-family: 'Mukta', sans-serif; }
    
    /* Breaking News Ticker */
    .ticker-wrap { background: #fff; border-bottom: 2px solid var(--ajtak-red); padding: 5px 0; overflow: hidden; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .ticker-flex { display: flex; align-items: center; }
    .ticker-label { background: var(--ajtak-red); color: #fff; padding: 5px 15px; font-weight: 800; border-radius: 0 20px 20px 0; position: relative; z-index: 2; font-size: 14px; }
    .ticker-scroll { display: flex; animation: ticker 40s linear infinite; white-space: nowrap; }
    .ticker-scroll a { color: #333; text-decoration: none; padding: 0 30px; font-weight: 600; font-size: 14px; border-right: 1px solid #ddd; }
    @keyframes ticker { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

    /* Aaj Tak Big Story Layout */
    .hero-container { display: grid; grid-template-columns: 2fr 1fr; gap: 15px; margin-bottom: 30px; }
    .main-story { position: relative; height: 520px; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
    .main-story img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
    .main-story:hover img { transform: scale(1.03); }
    .story-overlay { position: absolute; bottom: 0; left: 0; padding: 40px 30px; background: linear-gradient(transparent, rgba(0,0,0,0.95)); color: #fff; width: 100%; }
    .story-overlay h1 { font-weight: 800; font-size: 2.5rem; line-height: 1.2; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }

    .side-stories { display: flex; flex-direction: column; gap: 15px; }
    .small-card { position: relative; height: 252px; border-radius: 12px; overflow: hidden; }
    .small-card img { width: 100%; height: 100%; object-fit: cover; }
    .small-card-content { position: absolute; bottom: 0; left: 0; padding: 15px; background: linear-gradient(transparent, rgba(0,0,0,0.9)); color: #fff; width: 100%; }
    .small-card-content h5 { font-size: 1.1rem; font-weight: 700; }

    /* Premium Section Styling */
    .section-header { display: flex; align-items: center; justify-content: space-between; border-bottom: 3px solid #ddd; margin: 40px 0 25px; }
    .section-header h3 { background: var(--ajtak-red); color: #fff; padding: 8px 25px; font-weight: 800; border-radius: 5px 5px 0 0; margin-bottom: -3px; font-size: 1.4rem; }
    
    .news-card { background: #fff; border-radius: 12px; overflow: hidden; transition: 0.3s; height: 100%; border: 1px solid #eee; }
    .news-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    .news-card .thumb { position: relative; height: 180px; }
    .news-card img { width: 100%; height: 100%; object-fit: cover; }
    .news-card .body { padding: 15px; }
    .news-card .title { font-weight: 800; color: #222; text-decoration: none; font-size: 1.05rem; line-height: 1.4; display: block; }
    .news-card .meta { font-size: 12px; color: #888; margin-top: 10px; display: flex; justify-content: space-between; }

    /* Sticky Sidebar */
    .sticky-sidebar { position: sticky; top: 90px; }

    @media (max-width: 992px) {
        .hero-container { grid-template-columns: 1fr; }
        .main-story { height: 350px; }
        .story-overlay h1 { font-size: 1.5rem; }
        .container-fluid { padding: 0 15px; }
    }
</style>

<div class="ticker-wrap">
    <div class="ticker-flex">
        <div class="ticker-label"><i class="fas fa-bolt"></i> बड़ी खबरें</div>
        <div class="ticker-scroll">
            {% for item in top_5_highlights %}
                <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}">{{ item.title }}</a>
            {% endfor %}
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-9">
            
            {% if page_number == 1 %}
            <div class="hero-container">
                {% for item in top_5_highlights|slice:":1" %}
                <div class="main-story">
                    <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}">
                        <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}">
                        <div class="story-overlay">
                            <span class="badge bg-danger mb-2">{{ item.district }}</span>
                            <h1>{{ item.title }}</h1>
                            <p class="mt-2"><i class="far fa-calendar-alt"></i> {{ item.date|date:"d F, Y" }}</p>
                        </div>
                    </a>
                </div>
                {% endfor %}

                <div class="side-stories">
                    {% for item in top_5_highlights|slice:"1:3" %}
                    <div class="small-card">
                        <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}">
                            <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}">
                            <div class="small-card-content">
                                <h5>{{ item.title|truncatechars:70 }}</h5>
                            </div>
                        </a>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div class="section-header">
                <h3><i class="fas fa-map-marker-alt"></i> उत्तर प्रदेश (UP News)</h3>
            </div>
            <div class="row">
                {% for item in up_news|slice:":6" %}
                <div class="col-md-4 mb-4">
                    <div class="news-card">
                        <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="thumb">
                            <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}">
                        </a>
                        <div class="body">
                            <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="title">{{ item.title|truncatechars:75 }}</a>
                            <div class="meta">
                                <span><i class="fas fa-map-pin text-danger"></i> {{ item.district }}</span>
                                <span>{{ item.date|date:"d M" }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="section-header"><h3>भारत</h3></div>
                    {% for item in national_news %}
                    <div class="d-flex bg-white p-3 mb-3 rounded shadow-sm align-items-center">
                        <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}" style="width:100px; height:70px; object-fit:cover; border-radius:8px;">
                        <div class="ms-3">
                            <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="title" style="font-size:14px; font-weight:700; color:#333; text-decoration:none;">{{ item.title|truncatechars:60 }}</a>
                            <small class="text-muted d-block mt-1">{{ item.date|date:"d M, Y" }}</small>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    <div class="section-header"><h3>दुनिया</h3></div>
                    {% for item in world_news %}
                    <div class="d-flex bg-white p-3 mb-3 rounded shadow-sm align-items-center">
                        <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}" style="width:100px; height:70px; object-fit:cover; border-radius:8px;">
                        <div class="ms-3">
                            <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="title" style="font-size:14px; font-weight:700; color:#333; text-decoration:none;">{{ item.title|truncatechars:60 }}</a>
                            <small class="text-muted d-block mt-1">{{ item.date|date:"d M, Y" }}</small>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div class="section-header"><h3><i class="fas fa-clock"></i> ताज़ा अपडेट्स</h3></div>
            <div class="row">
                {% for item in other_news %}
                <div class="col-md-4 mb-4">
                    <div class="news-card">
                        <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="thumb">
                            <img src="{% if item.image_url %}{{ item.image_url }}{% elif item.image %}{{ item.image.url }}{% else %}{% static 'logo.png' %}{% endif %}">
                        </a>
                        <div class="body">
                            <a href="{% url 'news_detail' item.url_city|default:'news' item.slug %}" class="title">{{ item.title|truncatechars:80 }}</a>
                            <div class="meta">
                                <span class="text-muted">{{ item.date|date:"d F" }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

            <div class="mt-5 mb-5 text-center">
                <nav class="d-inline-block">
                    <ul class="pagination pagination-lg">
                        {% if other_news.has_previous %}
                            <li class="page-item"><a class="page-link border-0 shadow-sm mx-1 rounded" href="?page={{ other_news.previous_page_number }}">Prev</a></li>
                        {% endif %}
                        <li class="page-item active"><span class="page-link border-0 bg-danger shadow-sm mx-1 rounded">{{ other_news.number }}</span></li>
                        {% if other_news.has_next %}
                            <li class="page-item"><a class="page-link border-0 shadow-sm mx-1 rounded" href="?page={{ other_news.next_page_number }}">Next</a></li>
                        {% endif %}
                    </ul>
                </nav>
            </div>

        </div>

        <div class="col-lg-3">
            <div class="sticky-sidebar">
                {% include "mynews/sidebar.html" %}
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>AOS.init({duration:800,once:true});</script>
{% endblock %}
