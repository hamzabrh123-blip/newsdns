{% extends 'mynews/base.html' %}
{% load static %}

{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Devanagari:wght@400;700&family=Crimson+Pro:wght@400;600&display=swap" rel="stylesheet">

<style>
    :root { --news-red: #800000; --text-dark: #1a1a1a; --bg-gray: #f8f9fa; }
    body { background-color: var(--bg-gray); color: var(--text-dark); }

    .content-card {
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        padding: 30px;
        margin-bottom: 25px;
    }

    .article-title { 
        font-family: 'Noto Serif Devanagari', serif; 
        font-weight: 700; font-size: 2.2rem; 
        line-height: 1.3; color: #000; margin-bottom: 15px; 
    }

    .article-content { 
        font-family: 'Noto Serif Devanagari', serif; 
        font-size: 1.2rem; line-height: 1.9; color: #333; 
    }
    .article-content p { margin-bottom: 1.2rem; }

    .author-box { 
        border-top: 1px solid #eee; border-bottom: 1px solid #eee; 
        padding: 12px 0; margin-bottom: 20px;
    }

    .cat-badge { 
        background: var(--news-red); color: white; padding: 4px 12px; 
        font-weight: bold; font-size: 0.75rem; border-radius: 3px;
    }

    /* Video Container Fix */
    .ratio-16x9 {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 ratio */
        height: 0;
        overflow: hidden;
        border-radius: 8px;
    }
    .ratio-16x9 iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }

    @media (max-width: 768px) {
        .content-card { padding: 15px; border-radius: 0; }
        .article-title { font-size: 1.6rem; }
        .article-content { font-size: 1.1rem; }
    }
</style>

<div class="container mt-4">
    <div class="row">
        <div class="col-lg-8">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb small bg-transparent p-0">
                    <li class="breadcrumb-item"><a href="/" class="text-danger text-decoration-none fw-bold">HOME</a></li>
                    <li class="breadcrumb-item active text-uppercase">{{ news.category }}</li>
                </ol>
            </nav>

            <div class="content-card">
                <span class="cat-badge mb-2 d-inline-block">{{ news.get_district_display|default:"उत्तर प्रदेश" }}</span>
                <h1 class="article-title">{{ news.title }}</h1>

                <div class="author-box d-flex align-items-center">
                    <img src="https://ui-avatars.com/api/?name=U+W&background=800000&color=fff" class="rounded-circle me-3" width="40">
                    <div>
                        <p class="mb-0 fw-bold" style="font-size: 0.9rem;">By Uttar World Desk</p>
                        <small class="text-muted">
                            <i class="far fa-calendar-alt"></i> {{ news.date|date:"d M, Y" }} | {{ news.date|date:"h:i A" }}
                        </small>
                    </div>
                </div>

                <div class="mb-4">
                    <img src="{{ news.image_url }}" class="w-100 rounded shadow-sm" style="max-height: 450px; object-fit: cover;" onerror="this.src='{% static 'logo.png' %}';">
                </div>

                <div class="article-content" id="articleContent">
                    {{ news.content|safe }}
                </div>

               {% if v_id %}
                    <div class="video-container" style="margin: 20px 0;">
                        <iframe width="100%" height="315" 
                            src="https://www.youtube.com/embed/{{ v_id }}" 
                                frameborder="0" allowfullscreen>
                                    </iframe>
                        </div>
                {% endif %}
            </div>

            <div class="mt-4">
                <h4 class="fw-bold mb-3 border-bottom pb-2">सम्बन्धित खबरें</h4>
                <div class="row g-3">
                    {% for r in related_news|slice:":4" %}
                    <div class="col-md-6">
                        <div class="card h-100 border-0 shadow-sm">
                            <a href="{% url 'news_detail' r.url_city|default:'news' r.slug %}" class="text-decoration-none">
                                <img src="{{ r.image_url }}" class="card-img-top" style="height: 160px; object-fit: cover;" onerror="this.src='{% static 'logo.png' %}';">
                                <div class="card-body p-2">
                                    <h6 class="card-title text-dark fw-bold mb-0" style="font-size: 0.95rem;">{{ r.title|truncatechars:65 }}</h6>
                                </div>
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            {% include "mynews/sidebar.html" %}
        </div>
    </div>
</div>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3171847065256414" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var contentDiv = document.getElementById('articleContent');
        if (contentDiv) {
            var paragraphs = contentDiv.querySelectorAll('p');
            if (paragraphs.length >= 3) {
                var adCode = '<div class="my-4 text-center"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-in-article="true" data-ad-client="ca-pub-3171847065256414" data-ad-slot="5217172506"></ins></div>';
                paragraphs[1].insertAdjacentHTML('afterend', adCode);
                (adsbygoogle = window.adsbygoogle || []).push({});
            }
        }
    });
</script>
{% endblock %}
